@using Allup_Service.Dtos.CartDtos
@model List<CartItemDto>

@if (User.Identity.IsAuthenticated)
{
    @if(Model.Count > 0)
    {
        @foreach(var cartItem in Model) 
        {
            var product = cartItem.Product;

              <div class="mini-cart">
                                        <ul class="cart-items">
                                            <li>
                                                <div class="single-cart-item d-flex">
                                                    <div class="cart-item-thumb">
                                                        <a href="single-product.html"><img src="@cartItem.MainImage" alt="product"></a>
                                                        <span class="product-quantity">@cartItem.Count x</span>
                                                    </div>
                                                    <div class="cart-item-content media-body">
                                                        <h5 class="product-name"><a asp-controller="Shop" asp-action="Index">@cartItem.Product.Name</a></h5>
                                                        <span class="product-price">€@((cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100)).ToString("0.00"))</span>
                                                        <span class="product-color"><strong>Color:</strong> @cartItem.Product.Colors</span>
                                                        <a asp-action="DeleteBasket" asp-controller="Basket" asp-route-id="@cartItem.Product.Id" class="product-close delete-basket-btn"><i class="fal fa-times"></i></a>
                                                    </div>
                                                </div>
                                            </li>                                          
                                        </ul>
                                        <div class="price_content">
                                            <div class="cart-subtotals">
                                                <div class="products price_inline">
                                                    <span class="label">Subtotal</span>
                                                    <span class="value">€@((cartItem.Count * (cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100))).ToString("0.00"))</span>
                                                </div>
                                                @* <div class="shipping price_inline">
                                                    <span class="label">Shipping</span>
                                                    <span class="value">€7.00</span>
                                                </div>
                                                <div class="tax price_inline">
                                                    <span class="label">Taxes</span>
                                                    <span class="value">€0.00</span>
                                                </div> *@
                                            </div>
                                            <div class="cart-total price_inline">
                                                <span class="label">Total</span>
                                                <span class="value">€@((cartItem.Count * (cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100))).ToString("0.00"))</span>
                                            </div>
                                        </div> <!-- price content -->
                                        <div class="checkout text-center">
                                            <a asp-controller="Basket" asp-action="Index" class="main-btn">Checkout</a>
                                        </div>
                                         <div class="checkout text-center">
                                            <a asp-controller="Basket" asp-action="Index" class="main-btn">View Cart</a>
                                        </div>
        </div> <!-- mini cart -->
        }

        
    }
    else
    {
         <p>
            Cart is Empty
        </p>
    }
}
else
{
      @foreach(var cartItem in Model)
        {
            var product = cartItem.Product;

              <div class="mini-cart">
                                        <ul class="cart-items">
                                            <li>
                                                <div class="single-cart-item d-flex">
                                                    <div class="cart-item-thumb">
                                                        <a href="single-product.html"><img src="@cartItem.MainImage" alt="product"></a>
                                                        <span class="product-quantity">@cartItem.Count x</span>
                                                    </div>
                                                    <div class="cart-item-content media-body">
                                                        <h5 class="product-name"><a asp-controller="Shop" asp-action="Index">@cartItem.Product.Name</a></h5>
                                                        <span class="product-price">€@((cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100)).ToString("0.00"))</span>
                                                        <span class="product-color"><strong>Color:</strong> @cartItem.Product.Colors</span>
                                                        <a asp-action="DeleteBasket" asp-controller="Basket" asp-route-id="@cartItem.Product.Id" class="product-close delete-basket-btn"><i class="fal fa-times"></i></a>
                                                    </div>
                                                </div>
                                            </li>                                          
                                        </ul>
                                        <div class="price_content">
                                            <div class="cart-subtotals">
                                                <div class="products price_inline">
                                                    <span class="label">Subtotal</span>
                                                    <span class="value">€@((cartItem.Count * (cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100))).ToString("0.00"))</span>
                                                </div>
                                                @* <div class="shipping price_inline">
                                                    <span class="label">Shipping</span>
                                                    <span class="value">€7.00</span>
                                                </div>
                                                <div class="tax price_inline">
                                                    <span class="label">Taxes</span>
                                                    <span class="value">€0.00</span>
                                                </div> *@
                                            </div>
                                            <div class="cart-total price_inline">
                                                <span class="label">Total</span>
                                                <span class="value">€@((cartItem.Count * (cartItem.Product.CostPrice - (cartItem.Product.CostPrice * cartItem.Product.DiscountPercent/100))).ToString("0.00"))</span>
                                            </div>
                                        </div> <!-- price content -->
                                        <div class="checkout text-center">
                                            <a href="checkout.html" class="main-btn">Checkout</a>
                                        </div>
                                         <div class="checkout text-center">
                                            <a asp-controller="Basket" asp-action="Index" class="main-btn">View Cart</a>
                                        </div>
        </div> <!-- mini cart -->
        }

}